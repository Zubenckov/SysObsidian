### Смена имени на устройстве
```bash
hostname set-hostname [имя] # временное назначение имени
hostnamectl set-hostname [имя] # постоянное имя, но требуется перезагрузка
hostnamectl set-hostname [имя]; exec bash # сохранение без перезагрузки
```

### Работа с директориями
- Создание директории:
```bash
mkdir
mkdir -p # рекурсивное создание директории
> Пример:
> mkdir /etc/net/ifaces/enp0s8
```
- Переименование и перемещение директории / файла
```bash
mv изначальное_имя_директории итоговое_имя_директории
> Пример:
> mv /etc/net/ifaces/enp0s9 /etc/net/ifaces/enp0s8
> В данном примере, директория с именем enp0s9 будет переименована в enp0s8
```
>[!WARNING]
Данная команда предназначена как для переименования какой-то директории, так и для её переноса в другое место
### Создание файла
```bash
touch
> Пример:
> touch /etc/net/ifaces/enp0s3/ipv4address
> # В данном примере нами был создан файл ipv4address
```

### Получение конфигурации по DHCP
```bash
dhcpd # Получение настроек при DHCP
dhcpd -k # Удаление настроек выданных по DHCP
```

### Работа с пакетным менеджером apt-get
```bash
apt-get install [имя пакета] # Установка пакета
apt-get reinstall [имя пакета] # Переустановка пакета
apt-get remove [имя пакета] # Удаление пакета
apt-cache search [имя пакета] # Поиск пакета

> Пример: apt-get install iptables -y
> Флаг -y автоматически подтверждает установку пакета
```

### Настройка интерфейса
```bash
/etc/net/ifaces/[int_name]/ipv4address
/etc/net/ifaces/[int_name]/ipv4route
/etc/net/ifaces/[int_name]/options
```

- Перезагрузка сетевых конфигураций:
```bash
systemctl restart network
```

- Включение ip forwarding:
```bash
/etc/net/sysctl.conf
	net.ipv4_ip_forward=1
```

 - Включение модуля ядра 8021q:
```bash
modprobe 8021q # Включается до перезагрузки
echo "8021q" | tee -a /etc/modules # Постоянное вкл модуля 
```

### Отображение списка фалов и каталогов
- Команда ls(list)  основные флаги:
```bash
ls -a # Показывает все файлы, включая скрытые (начинаются с точки)
ls -l # Выводит подробнуюю информацию о файлах, включая права доступа, владельца, группу, размер и дату последней модификации
ls -lh # Флаг -h показывает размер файлов в удобочитаемом виде, например в КБ, МБ
ls -R # Рекурсивно выводит содержимое всех подкатологов
ls -lt # Флаг -t сортирует файлы по времени изменения (дефолт: от новых к старым)
ls -S # Сортирует файлы по размеру (дефолт: от больших к меньшим)
ls -lr # Флаг -r инвертирует порядок сортировки(например, для сортировки по времени от старых к новым или от меньших к большим)
ls  -d */ # Показывает информацию о каталоге как о файле(не перечисляет его содержимое)
ls -i # Показывает индексный номер каждого файла
```

- Команда lsblk(list block devices) - предназначена для отображения информации о блоковых устройствах. Точнее отображает список всех доступных блоковых устройств в системе, таких как диски, разделы и их монтированные точки. Основные флаги команды:
```bash
lsblk -a # Показывает все устройства, включая не смонтированные или скрытые устройства
lsblk -f # Показывает файловую систему для каждого устройства, а также информацию о метках и UUID
lsblk -l # Отображает устройства в виде списка(по одному на строку)
lsblk -o NAME,SIZE,TYPE,MOUNTPOINT # Указывает, какие колонки выводить. Можно выбрать, как пример, имя устройства, размер, тип и монтированную точку
lsblk -p # Показывает полный путь устройства
lsblk -r # Не выводит информацию о разделе
lsblk -t # Показывает таблицу всех устройств с их иерархией, к примеру для отображения всех разделов и их родителей
lsblk -n # Выводит только имена устройств без заголовков
lsblk -d # Показывает только физические устройства(без разделов)
```

### Добавление нового пользователя
```bash
useradd имя_пользователя
# Флаги:
> -M - не создавать домашний каталог
useradd -M test
> -N - не создавать группу с тем же именем что и у пользователя
useradd -N test
> -p - пароль
useradd -p пароль имя_пользователя
> -d - указание кастомного домашнего каталога
useradd -d путь_к_новому_каталогу имя пользователя
> --system - создание системного аккаунта без пароля и домашнего аккаунта
useradd --system test
```
Изменение пользователя
```bash
usermod -L новое_имя старое_имя
```
Смена пароля пользователю
```bash
passwd имя_пользователя
```
Изменение домашнего каталога пользователя
```bash
usermod -d новый_домашнйи_каталог -m имя_пользователя
```
Просмотр списка пользователей
```bash
cat /etc/passwd
```
Удаление пользователя
```bash
userdel имя_пользователя
userdel -f имя_пользователя # Удаляет залогиненнного пользователя
userdel -r имя_пользователя # Удаляет домашний каталог и почтовый ящик
```
Изменение UID и GID пользователя
```bash
usermod -u 777 имя_пользователя
```
### Группы для пользователей
```bash
cat /etc/group # Просмотр списка групп
```

Создание группы
```bash
groupadd имя_группы
```
Удаление группы
```bash
groupdel имя_группы
```

```bash
groups # Узнать группу текущего пользователя
groups имя_пользователя # группа конкретного пользователя
```
Принудительное назначение первичной группы
```bash
usermod -g группа имя_пользователя
```
Добавление в дополнительную группу
```bash
usermod -a -G группа имя_пользователя
```
Удалить пользователя из группы
```bash
gpasswd -d пользователь имя_группы
```

### Управление правами
> [!INFO] Для чего нужна chmod?
> 	chmod(от Change Mode) используется в Linux и других Unix-подобных системах для изменения прав доступа к файлам и директориям. С её помощью можно управлять тем кто и как может взаимодействовать с файлом - читать, записывать или выполнять его

```bash
chmod <флаг> установка_прав имя_файла
# Пример
> chmod -R 666 /home/test
```

```bash
Двоичная: 0) 000 1) 001 2) 010 3) 011 4) 100 5) 101 6) 110 7) 111
Восьмеричная:
0 --- # прав на файл/директории нет
1 --x # выполнение, на директории: чтение свойств файлов
2 -w- # запись, прав на директории нет
3 -wx # запись и выполнение, на директории: все кроме получения имени файлов
4 r-- # чтение, на директории: чтение имен файлов
5 r-x # чтение и выполнение, на директории: доступ на чтение файлов/их свойств
6 rw- # чтение и запись, на директории: чтение имен файлов
7 rwx # все права, на директории: все права
```

```bash
776, 775, 774, 766, 755 # Чтение, запись и исполнение
655, 644 # Чтение, запись
```

> Команда chown(change owner) - утилита, предназначенная для изменения владельца и/или группы для указанных файлов;

```bash
chown новый_владелец:новая_группа имя_файла
```
Новый владелец файла, пример
```bash
chown test:test /home/test/yes.txt
```
Новый владелец директории
```bash
chown test:test /home/user
# Флаги
> -R - новый владелец директории и его содержимого
```
### NAT через iptables
> [!INFO] Что такое iptables?
> Инструмент в Linux, который помогает контролировать, какой интернет-трафик может проходить через компьютер или сервер. Он работает как "фильтр", которые решает разрешить или заблокировать данные, которые приходят или уходят. Например, с его помощью можно запретить доступ к определенным сайтам, разрешить соединение только с определенных ip-адресов или защитить систему от атак.
- Установим нужные нам пакеты для работы:
```bash
apt-get install iptables
> # iptables - Мощный инструмент управления сетью в Linux, который позволяет администраторам управлять входящими и исходящими пакетами данных
```

- Настройка NAT через iptables
```bash
iptables -t nat -A POSTROUTING -o <int_name> -j MASQUERADE # не сохранится после перезапуска
```

- Для сохранения конфигурации NAT:
```bash
iptables-save >> /etc/sysconfig/iptables # Делаем чтобы правило iptables сохранялось
systemctl enable --now iptables # Ставим на автозагрузку при запуске
```
> [!WARNING]
> Для удаления правила, нужно просто убрать строку по пути /etc/sysconfig/iptables связанную с интерфейсом отвечающим за iptables
### Samba DC
> [!INFO] Что такое Samba DC?
> Программное обеспечение, которое позволяет Linux-серверам работать как контроллеры домена в сети Windows. Он управляет пользователями, компьютерами и доступом к ресурсам в сети, как это делает сервер Windows с Active Directory. С помощью Samba DC можно настроить централизованное управление доступом и безопасность всех устройств в сети, включая Windows, Linux и другие ОС
1. Создание домена
- Задаем имя на устройство:
```bash
> hostnamectl set-hostname test.domain.company 
> или же test.domain.prof
```
- Зададим доменное имя:
```bash
> domainname test.domain.company
> или же test.domain.prof
```
- В файле конфигурации /etc/resolv.conf впишем домен поиска и IP-Адрес нашего сервера:
```bash
search domain.name
nameserver [адрес сервера]
```

2. Настройка kerberos:
- Конфигурация /etc/krb5.conf:
```
Заменяем EXAMPLE.COM(написанное капсом - на такой же текст, но свой домен), маленькими буквами - аналогично
```
- После проведения конфигурации получаем билет kerberos: 
```
kinit Administrator@domain.name
> Пример: Administrator@ivanov.prof
```

- Для того чтобы узнать какие билеты kerberos были получены, можно использовать следующую команду:
```bash
klist
```

- Установка пакета на сервер:
```bash
apt-get install task-samba-dc
```

- Для дальнейшей развертки samba нужно удалить/создать следующие директории/файлы:
```bash
> rm -f /etc/samba/smb.conf # Перед созданием домена необходимо обязательно удалить данный файл
> rm -rf /var/lib/samba
> rm -rf /var/cache/samba
> mkdir -p /var/lib/samba/sysvol
```

- Создание домена:
```bash
samba-tool domain provision --use-rfc2307 --interactive
Где:
> --use-rfc2307 # Позволяет поддерживать расширенные атрибуты типа UID и GID в схеме LDAP и ACL на файловой системе Linux
> --interactive # интерактивные режим настройки samba
```

- Вывод устройств входящих в домен:
```bash
samba-tool computer-list
```

```
- Для подключения без графики потребуется ПК Администратора, с которого мы будем подключаться к настройке домена, на компьютере администратора нужно установить:
```bash
apt-get install admc gpui
> ADMC - инструмент для работы с доменом Active Directory и групповыми политиками
> GPUI - модуль режактирования настроек клиентской конфигурации, предназначен для настройки и изменения параметров групповой политики.
```
> [!WARNING] Для управления доменом, компьютер администратора должен находится в домене

- Для того, чтобы групповые политики применились на клиентском компьютере, следует установить следующий пакет:
```bash
apt-get install gpupdate
> gpupdate - команда заставляющая компьютер принудительно перечитать все политики с контроллера домена и заново применить все параметры
```
- После установки будет доступна следующая команда:
```bash
gpupdate # прописывается в terminal на клиенте, она должна скзать о том, что групповые политики на Компьютере и Пользоветеле успешно применены
> # Если же такого не выводится или выводится, но с ошибкой, значит стоит проверить правильности настройки домена/групповых политик
> # Групповые политики для Компьютера - применяются только для текущего компьютера
> # Групповые политики для Пользователя - применяются для всех пользователей/компьютеров находящихся в домене
```